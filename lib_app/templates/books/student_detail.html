{% extends 'books/base.html' %}
{% block title %}Student Details{% endblock %}

{% block content %}
<style>
    body {
        font-family: "Poppins", sans-serif;
        background-color: #f2f5f9;
        margin: 0;
        padding: 0;
    }

    .student-container {
        max-width: 850px;
        margin: 50px auto;
        padding: 0 20px;
    }

    .student-card {
        background: #fff;
        border-radius: 15px;
        padding: 30px 40px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        margin-bottom: 40px;
    }

    .borrowed-book {
        background: #f8f9fa;
        border-left: 5px solid #009879;
        padding: 15px 20px;
        border-radius: 10px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: background 0.3s, transform 0.2s;
    }

    .borrowed-book:hover {
        background: #eef6f5;
        transform: translateY(-2px);
    }

    .borrowed-book p {
        margin: 0;
        font-weight: 600;
        color: #222;
    }

    .borrowed-book small {
        color: #555;
        display: block;
        margin-top: 4px;
    }

    /* ðŸ”¥ Dropdown Styling */
    .status-select {
        padding: 8px 14px;
        border-radius: 8px;
        border: 2px solid transparent;
        font-size: 0.95rem;
        font-weight: 500;
        outline: none;
        cursor: pointer;
        transition: all 0.3s ease;
        appearance: none;
        background-repeat: no-repeat;
        background-position: right 0.8rem center;
        background-size: 14px;
    }

    /* Red button look for "Not Returned" */
    .status-select.not-returned {
        background-color: #ffe5e5;
        color: #d93025;
        border-color: #d93025;
    }

    /* Green button look for "Returned" */
    .status-select.returned {
        background-color: #e8f7ee;
        color: #0b7a2a;
        border-color: #0b7a2a;
    }

    .status-select:hover {
        filter: brightness(0.95);
    }

    .status-select:focus {
        box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.2);
    }

    .empty-state {
        text-align: center;
        background: #f4f4f4;
        border-radius: 10px;
        padding: 20px;
        color: #555;
        font-weight: 500;
    }
</style>

<div class="student-container">
    <!-- Student Info -->
    <div class="student-card">
        <h3 style="color: #009879; font-weight: 600;">{{ student.name }}</h3>
        <p><strong>Roll No:</strong> {{ student.roll_no }}</p>
        <p><strong>Email:</strong> {{ student.email }}</p>
        <p><strong>Total Books Due:</strong> {{ student.total_books_due }}</p>
    </div>

    <!-- Borrowed Books -->
    <div class="student-card">
        <h4 style="font-weight: 600; margin-bottom: 20px;">Borrowed Books</h4>

        {% if books %}
            {% for b in books %}
            <div class="borrowed-book">
                <div>
                    <p>{{ b.book.title }}</p>
                    <em>{{b.book.summary}}</em>
                    <small>ðŸ“… Issued on {{ b.issue_date|date:"M d, Y" }}</small>
                </div>

                <form method="post" action="{% url 'confirm_return' b.id %}">
                    {% csrf_token %}
                    <select name="status"
                            class="status-select not-returned"
                            onchange="
                                if(this.value === 'Returned') {
                                    this.classList.remove('not-returned');
                                    this.classList.add('returned');
                                    this.form.submit();
                                } else {
                                    this.classList.remove('returned');
                                    this.classList.add('not-returned');
                                }
                            ">
                        <option value="Not Returned" selected>ðŸ”´ Not Returned</option>
                        <option value="Returned">âœ… Returned</option>
                    </select>
                </form>
            </div>
            {% endfor %}
        {% else %}
        <div class="empty-state">No borrowed books.</div>
        {% endif %}
    </div>
</div>

{% endblock %}
