{% extends 'books/base.html' %}
{% block title %}Student Details{% endblock %}

{% block content %}
<style>
    body {
        font-family: "Poppins", sans-serif;
        background-color: #f2f5f9;
        margin: 0;
        padding: 0;
    }

    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .student-container {
        max-width: 800px;
        margin: 50px auto;
        padding: 0 20px;
        animation: fadeInUp 0.6s ease;
    }

    .student-card {
        background: #fff;
        border-radius: 15px;
        padding: 30px 40px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        margin-bottom: 40px;
        transition: box-shadow 0.3s ease-in-out;
    }

    .student-card:hover {
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
    }

    .student-card h3 {
        color: #009879;
        margin-bottom: 20px;
        font-weight: 600;
    }

    .student-card p {
        margin: 6px 0;
        color: #333;
        font-size: 1rem;
    }

    .btn-warning {
        display: inline-block;
        background-color: #ffb703;
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: 10px 16px;
        margin-top: 15px;
        font-weight: 500;
        cursor: pointer;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .btn-warning:hover {
        background-color: #f59e0b;
        transform: scale(1.05);
        box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3);
    }

    .borrowed-section h4 {
        font-weight: 600;
        color: #333;
        margin-bottom: 20px;
    }

    .borrowed-book {
        background: #f8f9fa;
        border-left: 5px solid #009879;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
        transition: all 0.3s ease-in-out;
        animation: fadeInUp 0.4s ease both;
    }

    .borrowed-book.returned {
        background: #e8f8f0;
        border-left: 5px solid #22c55e;
    }

    .borrowed-book:hover {
        background: #eef6f5;
        transform: translateY(-2px);
    }

    .borrowed-book p {
        margin: 0 0 8px 0;
        font-weight: 600;
        color: #222;
    }

    .borrowed-book small {
        color: #666;
    }

    .return-status {
        margin-top: 10px;
    }

    select {
        padding: 8px 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        outline: none;
        font-size: 0.9rem;
        transition: border 0.2s ease;
        cursor: pointer;
    }

    select:hover {
        border-color: #009879;
    }

    .empty-state {
        text-align: center;
        background: #f4f4f4;
        border-radius: 10px;
        padding: 20px;
        color: #555;
        font-weight: 500;
        animation: fadeInUp 0.6s ease;
    }

    @media (max-width: 600px) {
        .student-card {
            padding: 25px;
        }
        .student-card h3 {
            font-size: 1.2rem;
        }
        .borrowed-section h4 {
            font-size: 1.1rem;
        }
    }
    .return-status {
    display: inline-block;
    margin-top: 10px;
    background-color: #ffb703;
    color: white;
    padding: 8px 16px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s ease;
}

.return-status:hover {
    background-color: #f59e0b;
    transform: scale(1.05);
}

.borrowed-book.returned .return-status {
    background-color: #22c55e;
    color: #fff;
    cursor: default;
    pointer-events: none;
}

</style>

<div class="student-container">
    <!-- Student Info -->
    <div class="student-card">
        <h3>{{ student.name }}</h3>
        <p><strong>Roll No:</strong> {{ student.roll_no }}</p>
        <p><strong>Email:</strong> {{ student.email }}</p>
        <p><strong>Total Books Due:</strong> {{ student.total_books_due }}</p>
        <p><strong>Book Return Date:</strong> {{ borrower.return_date|date:"M d, Y" }}</p>

        {% if student.total_books_due > 0 %}
        <a href="mailto:{{ student.email }}?subject=Library Book Overdue Reminder&body={{ message|urlencode }}" class="btn-warning">
            üìß Send Overdue Reminder
        </a>
        {% endif %}
    </div>

    <!-- Borrowed Books -->
    <div class="borrowed-section">
        <h4>Borrowed Books</h4>
        {% if books %}
            {% for b in books %}
            <div class="borrowed-book {% if b.is_returned %}returned{% endif %}" id="borrowed_{{ b.id }}">
                <p>{{ b.book.title }}</p>
                <small>üìÖ Issued on {{ b.issue_date|date:"M d, Y" }}</small>
                 <a href="{% url 'confirm_return' b.id %}" class="btn-warning return-status">
                {% if b.is_returned %}
                    ‚úÖ Returned
                {% else %}
                    ‚ö†Ô∏è Mark as Returned
                {% endif %}
            </a>
                    
            </div>
            {% endfor %}
        {% else %}
        <div class="empty-state">No borrowed books.</div>
        {% endif %}
    </div>
</div>

{% endblock %}
